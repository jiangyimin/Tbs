(function(){$(function(){var e,a=abp.services.app.user,i=$("#dlg"),o=$("#dg"),t=i.find("form");a.getRoles().done(function(e){$("#roleName").combobox({data:e,valueField:"name",textField:"displayName"})}),$("#tb").children('a[name="add"]').click(function(e){i.dialog("open").dialog("setTitle","增加"),t.form("clear"),$("#UserName").next("span").find("input").focus()}),$("#tb").children('a[name="edit"]').click(function(a){return(e=$("#dg").datagrid("getSelected"))?(i.dialog("open").dialog("setTitle","修改"),t.form("load",e),void $("#UserName").attr("readonly","readonly")):void abp.notify.error("选择要修改的用户","",{positionClass:"toast-top-center"})}),$("#tb").children('a[name="remove"]').click(function(t){return(e=o.datagrid("getSelected"))?void abp.message.confirm("确定删除这一行吗？","请确定",function(t){t&&a.deleteUser(e.id).done(function(){abp.notify.info(e.name+" 被删除！"),i.dialog("close"),o.datagrid("reload")})}):void abp.notify.error("选择要删除的行","",{positionClass:"toast-top-center"})}),$("#dlg-tb").children('a[name="save"]').click(function(n){if(n.preventDefault(),t.form("validate")){var d=t.serializeFormToObject();abp.ui.setBusy(i);var l;l="增加"===i.panel("options").title?a.createUser(d):a.updateUser(e.id,d),l.done(function(){abp.notify.info(i.panel("options").title+"操作成功"),i.dialog("close"),o.datagrid("reload")}).always(function(){abp.ui.clearBusy(i)})}}),$("#dlg-tb").children('a[name="cancel"]').click(function(e){i.dialog("close")})})})();